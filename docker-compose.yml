services:
  moltpress:
    build: .
    container_name: moltpress
    restart: always
    ports:
      - "3002:3000"
    environment:
      # Pass the API key securely
      - API_KEY=${API_KEY}

      # Tell the app to store the DB in the mounted data volume
      - DB_PATH=/app/data/moltpress.sqlite

      - NODE_ENV=production
    user: "1000:1000"
    volumes:
      # Persist the Database
      - ./data:/app/data

      # Persist the Images
      - ./public/images:/app/public/images
